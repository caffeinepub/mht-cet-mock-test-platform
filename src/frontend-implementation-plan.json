{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Implement auto-transition logic between test sections",
  "requirements": [
    {
      "id": "REQ-37",
      "summary": "Update TestInterface.tsx to fetch test attempt state on mount and determine active section based on submission timestamps",
      "acceptanceCriteria": [
        "Component loads current attempt state from backend on mount",
        "If section1SubmittedAt is null, display Section 1",
        "If section1SubmittedAt is set but section2SubmittedAt is null, display Section 2",
        "If both sections are submitted, redirect to results page"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/TestInterface.tsx",
          "operation": "modify",
          "description": "Replace placeholder with working test interface that fetches test attempt state using getTestAttempt backend capability on mount, determines which section (1 or 2) to display based on section1SubmittedAt and section2SubmittedAt timestamps, and redirects to results page when both sections are completed. Extract attemptId from URL parameters using the existing urlParams utilities."
        }
      ]
    },
    {
      "id": "REQ-38",
      "summary": "Implement countdown timer in TestInterface.tsx that calculates remaining time and auto-submits section when time reaches zero",
      "acceptanceCriteria": [
        "Timer shows remaining time for the active section",
        "Timer updates every second",
        "When timer reaches 00:00, section is automatically submitted",
        "Auto-submission calls the submitSection endpoint with current answers"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/TestInterface.tsx",
          "operation": "modify",
          "description": "Add countdown timer logic that calculates remaining time by subtracting elapsed time (current time minus section start time) from 90 minutes (5400000 milliseconds), displays the countdown in MM:SS format, updates every second using useEffect with setInterval, and automatically calls submitSection backend capability with current answers when timer reaches 00:00. Handle cleanup of interval on component unmount."
        }
      ]
    },
    {
      "id": "REQ-39",
      "summary": "Add Submit Section button that submits answers and transitions to next section or results page",
      "acceptanceCriteria": [
        "Button is labeled 'Submit Section 1' or 'Submit Section 2' based on active section",
        "On successful submission of Section 1, UI immediately transitions to Section 2",
        "On successful submission of Section 2, user is redirected to results page",
        "Shows confirmation dialog before submission to prevent accidental clicks"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/TestInterface.tsx",
          "operation": "modify",
          "description": "Add Submit Section button that displays 'Submit Section 1' or 'Submit Section 2' label based on currentSection. Show confirmation dialog using a confirmation modal before submission. On confirmation, call submitSection backend capability with attemptId, current sectionNumber, and answers array. On successful submission of Section 1, trigger transition to Section 2. On successful submission of Section 2, navigate to results page using TanStack Router."
        }
      ]
    },
    {
      "id": "REQ-40",
      "summary": "Auto-start Section 2 after Section 1 submission by calling startSection backend capability",
      "acceptanceCriteria": [
        "Section 2 start is triggered automatically after Section 1 submission",
        "startSection API is called with sectionNumber=2",
        "Timer resets to 90 minutes for Section 2",
        "User sees Section 2 questions immediately after transition"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/TestInterface.tsx",
          "operation": "modify",
          "description": "After successful Section 1 submission, automatically call startSection backend capability with attemptId and sectionNumber=2 to record Section 2 start timestamp. Refetch test attempt data to update UI state, reset timer to 90 minutes for Section 2, and display Section 2 questions immediately."
        }
      ]
    },
    {
      "id": "REQ-41",
      "summary": "Display transition screen between Section 1 and Section 2 with summary and Start Section 2 button",
      "acceptanceCriteria": [
        "Transition screen appears immediately after Section 1 submission",
        "Shows count of questions attempted in Section 1",
        "Shows time taken to complete Section 1",
        "'Start Section 2' button calls startSection endpoint and loads Section 2 questions",
        "Screen is styled consistently with the Concept Delta navy blue theme"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/TestInterface.tsx",
          "operation": "modify",
          "description": "Add transition screen UI state that appears after Section 1 submission. Display 'Section 1 Complete!' message, show count of questions attempted in Section 1 (length of section1Answers array), calculate and display time taken (section1SubmittedAt minus section1StartTime converted to minutes and seconds), and render a 'Start Section 2' button. When clicked, call startSection backend capability with sectionNumber=2, then load Section 2 questions. Style using Concept Delta navy blue theme colors from Tailwind config."
        }
      ]
    },
    {
      "id": "REQ-44",
      "summary": "Add React Query hook useTestAttemptById to fetch test attempt data including timing and submission status",
      "acceptanceCriteria": [
        "Hook calls getTestAttempt backend endpoint",
        "Returns attempt data including section states and timestamps",
        "Implements proper error handling for invalid attempt IDs",
        "Query is enabled only when attemptId is provided"
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Add useTestAttemptById query hook that accepts attemptId parameter and calls actor.getTestAttempt(attemptId) to fetch test attempt data including testId, userId, currentSection, section1StartTime, section2StartTime, section1SubmittedAt, section2SubmittedAt, section1Answers, section2Answers, section1Score, section2Score, and isCompleted status. Enable query only when attemptId is provided (enabled: !!actor && !!attemptId). Implement error handling for invalid attempt IDs using retry: false."
        }
      ]
    },
    {
      "id": "REQ-45",
      "summary": "Create React Query mutation hooks for starting and submitting test sections with automatic cache invalidation",
      "acceptanceCriteria": [
        "startSection mutation calls backend startSection endpoint",
        "submitSection mutation calls backend submitSection endpoint with answers",
        "Both mutations invalidate test attempt queries on success",
        "Mutations handle errors and display appropriate error messages"
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useTestSectionMutations.ts",
          "operation": "create",
          "description": "Create new file with useTestSectionMutations hook that provides two mutations: startSection (accepts attemptId and sectionNumber, calls actor.startSection) and submitSection (accepts attemptId, sectionNumber, and answers array, calls actor.submitSection). Both mutations use useMutation from React Query with onSuccess callbacks that invalidate test attempt queries using queryClient.invalidateQueries. Implement error handling that logs errors and can optionally display user-facing error messages. Follow the pattern used in existing mutation hooks like useFullSyllabusTestMutations.ts."
        }
      ]
    }
  ]
}