{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add admin role verification popup on registration page",
  "requirements": [
    {
      "id": "REQ-133",
      "summary": "Add an informational popup that displays 'Only admin can assign user roles' when a user attempts to register an admin principal, explaining the authorization requirement",
      "acceptanceCriteria": [
        "A modal dialog or alert banner appears when the user clicks the 'Register as Admin' button",
        "The popup displays the exact text: 'Only admin can assign user roles'",
        "The popup clarifies that this is an admin-protected operation",
        "The popup appears before or after the registration attempt to inform users of the authorization requirement",
        "For the first admin registration (when no admins exist), the popup should also mention that the first registration is open for initial setup"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/ui/alert-dialog.tsx",
          "operation": "create",
          "description": "Create an AlertDialog component using shadcn/ui patterns for displaying informational popups. This component will be used to show the admin role assignment message. Verify the shadcn/ui component library's usage instructions before implementing."
        },
        {
          "path": "frontend/src/pages/AdminRegistration.tsx",
          "operation": "modify",
          "description": "Add an informational alert dialog that appears when the 'Register as Admin' button is clicked. The dialog should display 'Only admin can assign user roles' as the primary message, with additional context explaining that admin registration requires existing admin authorization (except for the first admin setup). The dialog should appear before the registration attempt is made, allowing users to cancel or proceed. Include conditional messaging that mentions first-time admin registration being open when no admins exist yet."
        }
      ]
    },
    {
      "id": "REQ-134",
      "summary": "Update the AdminRegistration component to display the 'Unauthorized: Only admins can assign user roles' error message prominently as a modal popup instead of just a toast notification",
      "acceptanceCriteria": [
        "When the backend returns an 'Unauthorized' error during admin registration, display it in a modal dialog or prominent alert",
        "The error popup includes the full error message explaining that only existing admins can assign admin roles",
        "The user can dismiss the popup with a close button or OK button",
        "The popup styling matches the existing UI design system",
        "For users who are already admins, clarify in the UI that they can successfully register other admins"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/AdminRegistration.tsx",
          "operation": "modify",
          "description": "Enhance error handling in the admin registration flow to display unauthorized errors in a modal dialog using the AlertDialog component. When the useAdminRegistration mutation returns an error containing 'Unauthorized' or when the backend returns an unauthorized result, open a modal dialog showing 'Unauthorized: Only admins can assign user roles' with a detailed explanation. The dialog should have a dismiss/OK button. Keep the existing toast notification system but add the prominent modal for critical authorization errors. For authenticated admin users, add helper text indicating they have permission to register other admins."
        },
        {
          "path": "frontend/src/hooks/useAdminRegistration.ts",
          "operation": "modify",
          "description": "Update the admin registration mutation hook to better expose unauthorized error states to the calling component. Ensure the hook properly propagates the RegistrationResult type including the unauthorized variant so that AdminRegistration.tsx can distinguish between different error types and display appropriate modal dialogs for authorization failures versus other errors."
        }
      ]
    }
  ]
}